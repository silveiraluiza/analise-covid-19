---
title: "Covid-19 Contaminação - João Pessoa"
author: "Luiza Carvalho"
date: "24/09/2020"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library("datetime")
library("ggplot2")
library("dplyr")
library("nortest")

```
# Análise Exploratória

## Importando os dados


```{r}
br <- read.csv("/Users/_nxtusr/Documents/covid_br.csv", sep=';', stringsAsFactors = FALSE)
jp <- read.csv("/Users/_nxtusr/Documents/covid_jp.csv", sep = ';')
cg <- read.csv("/Users/_nxtusr/Documents/covid_cg.csv", sep = ';')

```

## Visualização de Dados - Cenário Brasileiro

```{r  , echo=FALSE}

ggplot(br, aes(x = data, y = casosAcumulado, group = 1, color = "red")) +  geom_line() + labs(x = "Dias", y = "Quantidade", title = "Casos Acumulados - Brasil") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```


```{r  , echo=FALSE}

ggplot(br, aes(x = data, y = casosNovos, group = 1, color = "red")) +  geom_line() + labs(x = "Dias", y = "Quantidade", title = "Casos Novos - Brasil") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```

```{r  , echo=FALSE}

ggplot(br, aes(x = semanaEpi, y = casosNovos, group= semanaEpi)) +  geom_boxplot(color=  "red") + labs(x = "Semanas", y = "Quantidade", title = "Casos Novos x Semanas - Brasil") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```




## Visualização de Dados - Cenário João Pessoa

```{r  , echo=FALSE}

ggplot(jp, aes(x = data, y = casosAcumulado, group = 1)) +  geom_line(color = "blue") + labs(x = "Dias", y = "Quantidade", title = "Casos Acumulados - João Pessoa") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```


```{r  , echo=FALSE}

ggplot(br, aes(x = data, y = casosNovos, group = 1)) +  geom_line(color = "blue") + labs(x = "Dias", y = "Quantidade", title = "Casos Novos - João Pessoa") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```


```{r  , echo=FALSE}

ggplot(jp, aes(x = semanaEpi, y = casosNovos, group= semanaEpi)) +  geom_boxplot(color=  "blue") + labs(x = "Semanas", y = "Quantidade", title = "Casos Novos x Semanas - João Pessoa") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```

# Panorama Brasileiro

## Brasil: Separando os dados entre o mês de Julho e Agosto

```{r}

br$data <- as.Date(br$data , format = "%Y-%m-%d")
jp$data <- as.Date(jp$data , format = "%Y-%m-%d")

br_antes <- br %>% filter(data >= "2020-07-01" & data < "2020-08-01")
br_depois <- br %>% filter(data >= "2020-08-01" & data < "2020-09-01")

```

### Casos Novos Julho  - Brasil 

```{r , echo=FALSE}

ggplot(br_antes, aes(x = data, y = casosNovos, group = 1, color = "red")) +  geom_line() + labs(x = "Dias", y = "Quantidade", title = "Casos Novos - Brasil") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```

### Casos Novos Agosto  - Brasil 

```{r  , echo=FALSE}

ggplot(br_depois, aes(x = data, y = casosNovos, group = 1, color = "red")) +  geom_line() + labs(x = "Dias", y = "Quantidade", title = "Casos Novos - Brasil") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```



## Testes de Aderência de Anderson-Darling para os dados brasileiros

Foram considerados 3 testes de aderência para esse trabalho: Shapiro-Wilk,  Kolmogorov Smirno e Anderson-Darling.

1. No caso de pequenas amostras (n < 30) o teste de Shapiro-Wilk é mais apropriado que os testes K-S e Anderson-Darling, no entanto a amostra em questão é de n > 30 podemos descartar esse teste para um mais apropiado;

2.  A média e o desvio padrão da população são conhecidos, por isso em tese seria possível utilizar o teste de Kolmogorov Smirnov, no entanto ao tentar utilizá-lo foi recebida a seguinte mensagem de erro: "ties should not be present for the Kolmogorov-Smirnov test", que informa que valores repetidos não podem estar presentes no teste de Kolmogorov Smirnov, portanto se pode descartar esse teste para um mais aproppriado;

3. Desse modo será utilizado o teste de Anderson-Darling, onde:

H0: a amostra é selecionada de uma população que segue a distribuição normal

H1: a amostra selecionada da população não segue a distribuição normal


###  Julho 

```{r}
ad.test(br_antes$casosNovos)
```

A nossa estatística de teste A é igual a 0.49722 e o valor p correspondente é igual a 0.1967. Uma vez que o nosso valor p é superior a 0.05, não podemos rejeitar a hipótese nula e concluir que temos provas suficientes para dizer que estes dados não seguem uma distribuição normal.

###  Agosto

```{r}

ad.test(br_depois$casosNovos)

```

A nossa estatística de teste A é igual a 1.7871 e o valor p correspondente é igual a 0.0001098. Uma vez que o nosso valor p é inferior a 0.05, podemos rejeitar a hipótese nula e concluir que temos provas suficientes para dizer que estes dados não seguem uma distribuição normal.

## Teste de Hipóteses

### t-test

H0: μantes = μantes (ou μΔ = 0)

H1: μantes > μdepois

```{r}

t.test(br_antes$casosNovos, br_depois$casosNovos, paired = F, alternative = "greater")

```

Não é possível rejeitar H0 em favor de H1, pois p-value é maior que 0,05.


### Teste de Hipótese (Wilcoxon)


H0: μantes = μantes (ou μΔ = 0)

H1: μantes > μdepois


```{r}

wilcox.test(br_antes$casosNovos, br_depois$casosNovos, paired = F, alternative = "greater")

```

Não é possível rejeitar H0 em favor de H1, pois p-value é maior que 0,05.

## Conclusão

A média de casos novos de covid no Brasil não pode ser considerada menor em agosto do que a média de casos de covid em julho.

# Para o caso de João Pessoa

### João Pessoa: Separando os dados entre os  80 primeiros dias e os  80 últimos dias

```{r}

jp_antes <- jp %>% filter(data >= "2020-07-01" & data < "2020-08-01")
jp_depois <- jp %>% filter(data >= "2020-08-01" & data < "2020-09-01")

```

### Casos Novos Julho - João Pessoa 

```{r, echo=FALSE}

ggplot(jp_antes, aes(x = data, y = casosNovos, group = 1)) +  geom_line(color = "blue") + labs(x = "Dias", y = "Quantidade", title = "Casos Novos - João Pessoa") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```

### Casos Novos Agosto - João Pessoa 

```{r , echo=FALSE}

ggplot(jp_depois, aes(x = data, y = casosNovos, group = 1)) +  geom_line(color = "blue") + labs(x = "Dias", y = "Quantidade", title = "Casos Novos - João Pessoa") + theme( axis.text.x = element_blank(), axis.ticks = element_blank(), legend.position = "none")

```



## Testes de Aderência de Anderson-Darling para os dados de João Pessoa

Foram considerados 3 testes de aderência para esse trabalho: Shapiro-Wilk,  Kolmogorov Smirno e Anderson-Darling.

1. No caso de pequenas amostras (n < 30) o teste de Shapiro-Wilk é mais apropriado que os testes K-S e Anderson-Darling, no entanto a amostra em questão é de n > 30 podemos descartar esse teste para um mais apropiado;

2.  A média e o desvio padrão da população são conhecidos, por isso em tese seria possível utilizar o teste de Kolmogorov Smirnov, no entanto ao tentar utilizá-lo foi recebida a seguinte mensagem de erro: "ties should not be present for the Kolmogorov-Smirnov test", que informa que valores repetidos não podem estar presentes no teste de Kolmogorov Smirnov, portanto se pode descartar esse teste para um mais aproppriado;

3. Desse modo será utilizado o teste de Anderson-Darling, onde:

H0: a amostra é selecionada de uma população que segue a distribuição normal

H1: a amostra selecionada da população não segue a distribuição normal


###  Julho

```{r}
ad.test(jp_antes$casosNovos)
```

A nossa estatística de teste A é igual a 0.40026 e o valor p correspondente é igual a 0.3418. Uma vez que o nosso valor p é superior a 0.05, não podemos rejeitar a hipótese nula e concluir que temos provas suficientes para dizer que estes dados não seguem uma distribuição normal.

###  Agosto
```{r}

ad.test(jp_depois$casosNovos)

```

A nossa estatística de teste A é igual a 0.66493 e o valor p correspondente é igual a 0.07469. Uma vez que o nosso valor p é superior a 0.05, não podemos rejeitar a hipótese nula e concluir que temos provas suficientes para dizer que estes dados não seguem uma distribuição normal.


## Teste de Hipóteses

### t-test

H0: μantes = μdepois (ou μΔ = 0)

H1: μantes > μdepois

```{r}

t.test(jp_antes$casosNovos, jp_depois$casosNovos, paired = F, alternative = "greater")

```

É possível rejeitar H0 em favor de H1, pois p-value é menor que 0,05.


### Teste de Hipótese (Wilcoxon)

H0: μantes = μdepois (ou μΔ = 0)

H1: μantes > μdepois

```{r}

wilcox.test(jp_antes$casosNovos, jp_depois$casosNovos, paired = F, alternative = "greater")

```

É possível rejeitar H0 em favor de H1, pois p-value é menor que 0,05.


## Conclusão

A média de casos novos de covid em João Pessoa pode ser considerada menor no mês de Agosto do que a média de casos de covid nos mês de Julho.